define(["jquery","core/chartjs","report_usage/color"],function(a,b,c){function d(a,b){var c=[],d=JSON.parse(localStorage.getItem("report_usage_visibility_"+h));for(var e in a){var f=!0;null!==d&&d[e]===!1&&(f=!1),c.push({objid:e,fill:!1,label:b[e],hidden:f,data:a[e],borderColor:g[c.length%g.length]})}return c}function e(a){var b=a.config.data.datasets,c={};for(var d in b){var e=b[d];c[e.objid]=!a.isDatasetVisible(d)}localStorage.setItem("report_usage_visibility_"+h,JSON.stringify(c))}function f(a,f,i,j){g=c.createColors(),h=j;var k=document.getElementById("report_usage_chart").getContext("2d"),l=new b(k,{type:"line",data:{labels:f,datasets:d(a,i)},options:{onClick:function(){setTimeout(e,200,l)}}})}var g,h;return{init:f}});